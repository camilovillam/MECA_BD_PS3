##Limpiar el entorno ----
rm(list=ls())
library(pacman)
p_load(rio,
sf,
doParallel,
gtsummary,
GGally,
stargazer,
fabricatr,
tableone,
arsenal,
janitor,
tidyverse,
gamlr,
skimr,
caret,
rvest,
stargazer,
smotefamily,
MASS,
ROCR,
pROC,
rpart,
rpart.plot,
glmnet,
xgboost)
setwd("~/GitHub/MECA_BD_PS3")
train_prop <-readRDS("./stores/train.rds")
test_prop <-readRDS("./stores/test.rds")
upla<-read_sf("./stores/upla/UPla.shp")
localidades_bog <- read_sf("./stores/localidades_Bog_shp/Loca.shp")
sitios_ref <- data.frame(place="Uniandes",
lat=4.601590,
long=-74.066391,
nudge_y=-0.001)
sitios_ref <- sitios_ref %>% mutate(latp=lat,longp=long)
sitios_ref <- st_as_sf(sitios_ref,coords=c('longp','latp'),crs=4326)
prop_subset <- head(train_prop)
prop_subset <- prop_subset %>% mutate(latp=lat,longp=lon)
prop_subset <- st_as_sf(prop_subset,coords=c('longp','latp'),crs=4326)
loc_bog <- read_sf("./stores/localidades_Bog_shp/Loca.shp")
st_crs(ciclovias)
ciclovias <- read_sf("./stores/Ciclovia/Ciclovia.shp")
st_crs(ciclovias)
st_crs(prop_subset)
st_crs(sitios_ref)
st_crs(upla)
st_crs(loc_bog)
ciclovias<-st_transform(ciclovias, 4686)
st_crs(ciclovias)
ciclovias<-st_transform(ciclovias, 4686)
ciclovias<-st_transform(prop_subset, 4686)
ciclovias<-st_transform(sitios_ref, 4686)
ciclovias<-st_transform(upla, 4686)
ciclovias<-st_transform(loc_bog, 4686)
st_crs(ciclovias)
st_crs(prop_subset)
st_crs(sitios_ref)
st_crs(upla)
st_crs(loc_bog)
ciclovias <- read_sf("./stores/Ciclovia/Ciclovia.shp")
ciclovias<-st_transform(ciclovias, 4686)
prop_subset<-st_transform(prop_subset, 4686)
sitios_ref<-st_transform(sitios_ref, 4686)
upla<-st_transform(upla, 4686)
loc_bog<-st_transform(loc_bog, 4686)
st_crs(ciclovias)
st_crs(prop_subset)
st_crs(sitios_ref)
st_crs(upla)
st_crs(loc_bog)
ggplot()+
geom_sf(data=upla
%>% filter(grepl("RIO",UPlNombre)==FALSE),
fill = NA) +
geom_sf(data=sitios_ref, col="red") +
geom_sf(data=ciclovias, col="blue") +
geom_sf(data=loc_bog, col="green") +
geom_sf(data=prop_subset, col="orange") +
theme_bw() +
theme(axis.title =element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.text = element_text(size=6))
View(loc_bog)
View(localidades_bog)
ggplot()+
geom_sf(data=upla
%>% filter(grepl("RIO",UPlNombre)==FALSE),
fill = NA) +
geom_sf(data=loc_bogota
%>% filter(grepl("CHAPINERO",LocNombre)==FALSE),
fill = "green") +
geom_sf(data=sitios_ref, col="red") +
geom_sf(data=ciclovias, col="blue") +
geom_sf(data=prop_subset, col="orange") +
theme_bw() +
theme(axis.title =element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.text = element_text(size=6))
ggplot()+
geom_sf(data=upla
%>% filter(grepl("RIO",UPlNombre)==FALSE),
fill = NA) +
geom_sf(data=loc_bog
%>% filter(grepl("CHAPINERO",LocNombre)==FALSE),
fill = "green") +
geom_sf(data=sitios_ref, col="red") +
geom_sf(data=ciclovias, col="blue") +
geom_sf(data=prop_subset, col="orange") +
theme_bw() +
theme(axis.title =element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.text = element_text(size=6))
ggplot()+
geom_sf(data=upla
%>% filter(grepl("RIO",UPlNombre)==FALSE),
fill = NA) +
geom_sf(data=loc_bog
%>% filter(grepl("CHAPINERO",LocNombre)==FALSE),
fill = "lila") +
geom_sf(data=sitios_ref, col="red") +
geom_sf(data=ciclovias, col="blue") +
geom_sf(data=prop_subset, col="orange") +
theme_bw() +
theme(axis.title =element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.text = element_text(size=6))
ggplot()+
geom_sf(data=upla
%>% filter(grepl("RIO",UPlNombre)==FALSE),
fill = NA) +
geom_sf(data=loc_bog
%>% filter(grepl("CHAPINERO",LocNombre)==FALSE),
fill = "pink") +
geom_sf(data=sitios_ref, col="red") +
geom_sf(data=ciclovias, col="blue") +
geom_sf(data=prop_subset, col="orange") +
theme_bw() +
theme(axis.title =element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.text = element_text(size=6))
ggplot()+
geom_sf(data=upla
%>% filter(grepl("RIO",UPlNombre)==FALSE),
fill = NA) +
geom_sf(data=sitios_ref, col="red") +
geom_sf(data=ciclovias, col="blue") +
geom_sf(data=prop_subset, col="orange") +
theme_bw() +
theme(axis.title =element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.text = element_text(size=6))
ggplot()+
geom_sf(data=loc_bog
%>% filter(grepl("CHAPINERO",LocNombre)==FALSE),
fill = "pink") +
ggplot()+
geom_sf(data=loc_bog
%>% filter(grepl("CHAPINERO",LocNombre)==FALSE),
fill = "pink"))
ggplot()+
geom_sf(data=loc_bog
%>% filter(grepl("CHAPINERO",LocNombre)==FALSE),
fill = "pink")
?grepl
ggplot()+
geom_sf(data=loc_bog
%>% filter(grepl("CHAPINERO",LocNombre)==TRUE),
fill = "pink")
ggplot()+
geom_sf(data=upla
%>% filter(grepl("RIO",UPlNombre)==FALSE),
fill = NA) +
geom_sf(data=sitios_ref, col="red") +
geom_sf(data=ciclovias, col="blue") +
geom_sf(data=prop_subset, col="orange") +
ggplot()+
geom_sf(data=loc_bog
%>% filter(grepl("CHAPINERO",LocNombre)==TRUE),
fill = "pink")+
theme_bw() +
theme(axis.title =element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.text = element_text(size=6))
ggplot()+
geom_sf(data=upla
%>% filter(grepl("RIO",UPlNombre)==FALSE),
fill = NA) +
geom_sf(data=loc_bog
%>% filter(grepl("CHAPINERO",LocNombre)==TRUE),
fill = "pink")+
geom_sf(data=sitios_ref, col="red") +
geom_sf(data=ciclovias, col="blue") +
geom_sf(data=prop_subset, col="orange") +
theme_bw() +
theme(axis.title =element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.text = element_text(size=6))
train_prop <- train_prop %>% mutate(latp=lat,longp=lon)
train_prop <- st_as_sf(train_prop ,coords=c('longp','latp'),crs=4686)
View(train_prop)
st_crs(train_prop)
ggplot()+
geom_sf(data=upla
%>% filter(grepl("RIO",UPlNombre)==FALSE),
fill = NA) +
geom_sf(data=loc_bog
%>% filter(grepl("CHAPINERO",LocNombre)==TRUE),
fill = "pink")+
geom_sf(data=sitios_ref, col="red") +
geom_sf(data=ciclovias, col="blue") +
geom_sf(data=train_prop, col="orange") +
theme_bw() +
theme(axis.title =element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.text = element_text(size=6))
ggplot()+
geom_sf(data=upla
%>% filter(grepl("RIO",UPlNombre)==FALSE),
fill = NA) +
geom_sf(data=loc_bog
%>% filter(grepl("CHAPINERO",LocNombre)==TRUE),
fill = "pink")+
geom_sf(data=sitios_ref, col="red") +
geom_sf(data=ciclovias, col="blue") +
geom_sf(data=train_prop
%>% filter(grepl("Cundinamarca",l2)==TRUE),
col="orange") +
theme_bw() +
theme(axis.title =element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.text = element_text(size=6))
test_prop <- test_prop %>% mutate(latp=lat,longp=lon)
test_prop <- st_as_sf(test_prop ,coords=c('longp','latp'),crs=4686)
ggplot()+
geom_sf(data=upla
%>% filter(grepl("RIO",UPlNombre)==FALSE),
fill = NA) +
geom_sf(data=loc_bog
%>% filter(grepl("CHAPINERO",LocNombre)==TRUE),
fill = "pink")+
geom_sf(data=sitios_ref, col="red") +
geom_sf(data=ciclovias, col="blue") +
geom_sf(data=test_prop
%>% filter(grepl("Cundinamarca",l2)==TRUE),
col="orange") +
theme_bw() +
theme(axis.title =element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.text = element_text(size=6))
ggplot()+
geom_sf(data=upla
%>% filter(grepl("RIO",UPlNombre)==FALSE),
fill = NA) +
geom_sf(data=loc_bog
%>% filter(grepl("CHAPINERO",LocNombre)==TRUE),
fill = "pink")+
geom_sf(data=sitios_ref, col="red") +
geom_sf(data=ciclovias, col="blue") +
geom_sf(data=test_prop
%>% filter(grepl("Cundinamarca",l2)==TRUE),
col="orange",
size=1) +
theme_bw() +
theme(axis.title =element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.text = element_text(size=6))
ggplot()+
geom_sf(data=upla
%>% filter(grepl("RIO",UPlNombre)==FALSE),
fill = NA) +
geom_sf(data=loc_bog
%>% filter(grepl("CHAPINERO",LocNombre)==TRUE),
fill = "pink")+
geom_sf(data=sitios_ref, col="red") +
geom_sf(data=ciclovias, col="blue") +
geom_sf(data=prop_subset, col="green") +
geom_sf(data=test_prop
%>% filter(grepl("Cundinamarca",l2)==TRUE),
col="orange",
size=1) +
theme_bw() +
theme(axis.title =element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.text = element_text(size=6))
ggplot()+
geom_sf(data=loc_bog
%>% filter(grepl("CHAPINERO",LocNombre)==TRUE),
fill = "pink")+
geom_sf(data=test_prop
%>% filter(grepl("Cundinamarca",l2)==TRUE),
col="orange",
size=1) +
theme_bw() +
theme(axis.title =element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.text = element_text(size=6))
ggplot()+
geom_sf(data=loc_bog
%>% filter(grepl("CHAPINERO",LocNombre)==TRUE),
fill = NULL)+
geom_sf(data=test_prop
%>% filter(grepl("Cundinamarca",l2)==TRUE),
col="orange",
size=1) +
theme_bw() +
theme(axis.title =element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.text = element_text(size=6))
ggplot()+
geom_sf(data=loc_bog
%>% filter(grepl("CHAPINERO",LocNombre)==TRUE),
fill = NA)+
geom_sf(data=test_prop
%>% filter(grepl("Cundinamarca",l2)==TRUE),
col="orange",
size=1) +
theme_bw() +
theme(axis.title =element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.text = element_text(size=6))
